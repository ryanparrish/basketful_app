{% extends "admin/base_site.html" %}
{% load static %}

{% block content %}
<div id="content-main">
    <h1>Create Combined Order</h1>
    
    <div style="background-color: #e8f4f8; border-left: 4px solid #2196F3; padding: 15px; margin-bottom: 20px; border-radius: 4px;">
        <h3 style="margin-top: 0; color: #1976D2;">
            <span style="font-size: 1.2em;">ℹ️</span> How to Create a Combined Order
        </h3>
        <ol style="margin-bottom: 0; line-height: 1.8;">
            <li><strong>Select Program & Dates:</strong> Choose the program and date range for orders to combine.</li>
            <li><strong>Preview:</strong> Review eligible orders, totals, and packing split before confirming.</li>
            <li><strong>Confirm:</strong> Create the combined order and download PDFs.</li>
        </ol>
    </div>
    
    {% if messages %}
        {% for message in messages %}
            <div class="messagelist">
                <li class="{{ message.tags }}">{{ message }}</li>
            </div>
        {% endfor %}
    {% endif %}

    <form method="post" action="">
        {% csrf_token %}
        
        <fieldset class="module aligned">
            <h2>Step 1: Select Program and Time Frame</h2>
            
            <div class="form-row">
                {{ form.program.errors }}
                <div>
                    <label for="{{ form.program.id_for_label }}">{{ form.program.label }}:</label>
                    {{ form.program }}
                    {% if form.program.help_text %}
                        <p class="help">{{ form.program.help_text }}</p>
                    {% endif %}
                </div>
            </div>
            
            <div class="form-row">
                {{ form.start_date.errors }}
                <div>
                    <label for="{{ form.start_date.id_for_label }}">{{ form.start_date.label }}:</label>
                    {{ form.start_date }}
                    {% if form.start_date.help_text %}
                        <p class="help">{{ form.start_date.help_text }}</p>
                    {% endif %}
                </div>
            </div>
            
            <div class="form-row">
                {{ form.end_date.errors }}
                <div>
                    <label for="{{ form.end_date.id_for_label }}">{{ form.end_date.label }}:</label>
                    {{ form.end_date }}
                    {% if form.end_date.help_text %}
                        <p class="help">{{ form.end_date.help_text }}</p>
                    {% endif %}
                </div>
            </div>
            
            {% if form.non_field_errors %}
                <div class="form-row errors">
                    {{ form.non_field_errors }}
                </div>
            {% endif %}
        </fieldset>
        
        <fieldset class="module aligned collapse">
            <h2>Advanced Options</h2>
            
            <div class="form-row">
                {{ form.split_strategy_override.errors }}
                <div>
                    <label for="{{ form.split_strategy_override.id_for_label }}">{{ form.split_strategy_override.label }}:</label>
                    {{ form.split_strategy_override }}
                    {% if form.split_strategy_override.help_text %}
                        <p class="help">{{ form.split_strategy_override.help_text }}</p>
                    {% endif %}
                </div>
            </div>
        </fieldset>
        
        <div class="submit-row">
            <input type="submit" value="Preview Orders →" class="default">
            <a href="{% url 'admin:orders_combinedorder_changelist' %}" class="button cancel-link">Cancel</a>
        </div>
    </form>
</div>
{% endblock %}
